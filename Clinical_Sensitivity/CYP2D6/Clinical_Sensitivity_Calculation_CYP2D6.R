#Cyp2D6 Sensitivity
setwd("~/Desktop/Clinical_Sensitivity/CYP2D6")



#"Cyp2D6_Frequencies", this brings gene frequency data for each of the ethnic groups, values come from PharmGKB database
#Each column represents an ethnic group, each row represents a gene variant, values in the table are the gene frequency
#removes NA values replaces wtih 0, and names the rows after gene variant names
Cyp2D6_Frequencies<- read_excel("Cyp2D6_Frequencies.xlsx")
Cyp2D6_Frequencies<- as.data.frame(Cyp2D6_Frequencies)                                                                        
Cyp2D6_Frequencies[is.na(Cyp2D6_Frequencies)]<- 0
rownames(Cyp2D6_Frequencies)<- Cyp2D6_Frequencies$`CYP2D6 Allele`



#"Cyp2D6_Tests", this brings gene test coverage data collected in our study
#each column represents a specific genetic test, the rows represent each gene variant, "Yes" means gene is covered, "No" means it is not
#row names changed to be the name of each gene variant
Cyp2D6_Tests<- read_excel("Cyp2D6Tests.xlsx")
Cyp2D6_Tests<- as.data.frame(Cyp2D6_Tests)
rownames(Cyp2D6_Tests)<- Cyp2D6_Frequencies$`CYP2D6 Allele`
Cyp2D6_Counts<- as.data.frame(read_excel("Cyp2D6Tests.xlsx", sheet= "Sheet2"))



#"Cyp2C9_Phenotypes", loads table with each potential diplotype and corresponding phenotype, from PharmGKB reference
#each gene of the diplotype has its own column (A1 and A2), the column "Phenotype" designates the metabolizing status of each diplotype,each diplotype is designated as heterozygous(2) or homozygous(1) in a column called multiply
Cyp2D6_Phenotypes<- read_excel("Cyp2D6_Diplotypes.xlsx")
Cyp2D6_Phenotypes<- as.data.frame(Cyp2D6_Phenotypes)
Cyp2D6_Phenotypes<- Cyp2D6_Phenotypes[!duplicated(Cyp2D6_Phenotypes$`CYP2D6 Diplotype`),]
Cyp2D6_Phenotypes<- separate(data= Cyp2D6_Phenotypes, col= 'CYP2D6 Diplotype', into= c("A1", "A2"), sep= "/")
colnames(Cyp2D6_Phenotypes)<- c("A1", "A2", "Score","Phenotype", "EHR")
Cyp2D6_Phenotypes[Cyp2D6_Phenotypes== "*2 "]<- "*2"
Cyp2D6_Phenotypes$Multiply<- ifelse(Cyp2D6_Phenotypes$A1 == Cyp2D6_Phenotypes$A2, 1, 2)



#takes the same Phenotype table "Cyp2C9_Phenotypes" described above with the same columns, creates a new table called "Cyp2C9_Phenotypes_Test" and makes additional adjustments
#takes the variant names listed in A1 and A2 in the phenotype table and replaces it with a "Yes" or a "No" depending on whether or not the PGx test being assessed covers the gene
#For each calculation of clinical sensitivity, the Test Name has to be replaced in the column title of the Cyp2C19_Tests
Cyp2D6_Phenotypes_Test<- Cyp2D6_Phenotypes
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*1"]<- Cyp2D6_Tests["*1","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*1x2"]<- Cyp2D6_Tests["*1x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*1xN>2"]<- Cyp2D6_Tests["*1≥3","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*2"]<- Cyp2D6_Tests["*2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*2x2"]<- Cyp2D6_Tests["*2x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*2xN>2"]<- Cyp2D6_Tests["*2≥3","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*3"]<- Cyp2D6_Tests["*3","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*3xN"]<- Cyp2D6_Tests["*3x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*4"]<- Cyp2D6_Tests["*4","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*4xN"]<- Cyp2D6_Tests["*4≥2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*5"]<- Cyp2D6_Tests["*5","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*6"]<- Cyp2D6_Tests["*6","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*6xN"]<- Cyp2D6_Tests["*6x2","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*7"]<- Cyp2D6_Tests["*7","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*8"]<- Cyp2D6_Tests["*8","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*9"]<- Cyp2D6_Tests["*9","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*9x2"]<- Cyp2D6_Tests["*9x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*10"]<- Cyp2D6_Tests["*10","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*10x2"]<- Cyp2D6_Tests["*10x2","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*11"]<- Cyp2D6_Tests["*11","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*12"]<- Cyp2D6_Tests["*12","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*8"]<- Cyp2D6_Tests["*8","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*9"]<- Cyp2D6_Tests["*9","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*9x2"]<- Cyp2D6_Tests["*9x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*10"]<- Cyp2D6_Tests["*10","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*11"]<- Cyp2D6_Tests["*11","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*12"]<- Cyp2D6_Tests["*12","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*13"]<- Cyp2D6_Tests["*13","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*14"]<- Cyp2D6_Tests["*14","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*15"]<- Cyp2D6_Tests["*15","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*16"]<- Cyp2D6_Tests["*16","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*17"]<- Cyp2D6_Tests["*17","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*17x2"]<- Cyp2D6_Tests["*17x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*18"]<- Cyp2D6_Tests["*18","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*19"]<- Cyp2D6_Tests["*19","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*20"]<- Cyp2D6_Tests["*20","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*21"]<- Cyp2D6_Tests["*21","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*22"]<- Cyp2D6_Tests["*22","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*23"]<- Cyp2D6_Tests["*23","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*24"]<- Cyp2D6_Tests["*24","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*25"]<- Cyp2D6_Tests["*25","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*26"]<- Cyp2D6_Tests["*26","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*27"]<- Cyp2D6_Tests["*27","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*28"]<- Cyp2D6_Tests["*28","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*29"]<- Cyp2D6_Tests["*29","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*29x2"]<- Cyp2D6_Tests["*29x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*30"]<- Cyp2D6_Tests["*30","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*31"]<- Cyp2D6_Tests["*31","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*32"]<- Cyp2D6_Tests["*32","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*33"]<- Cyp2D6_Tests["*33","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*34"]<- Cyp2D6_Tests["*34","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*35"]<- Cyp2D6_Tests["*35","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*35x2"]<- Cyp2D6_Tests["*35x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*36"]<- Cyp2D6_Tests["*36","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*36xN"]<- Cyp2D6_Tests["*36x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*37"]<- Cyp2D6_Tests["*37","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*38"]<- Cyp2D6_Tests["*38","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*39"]<- Cyp2D6_Tests["*39","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*40"]<- Cyp2D6_Tests["*40","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*41"]<- Cyp2D6_Tests["*41","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*41x2"]<- Cyp2D6_Tests["*41x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*42"]<- Cyp2D6_Tests["*42","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*43"]<- Cyp2D6_Tests["*43","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*43xN"]<- Cyp2D6_Tests["*43x2","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*44"]<- Cyp2D6_Tests["*44","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*45"]<- Cyp2D6_Tests["*45","MedMPact"] 
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*45x2"]<- Cyp2D6_Tests["*45x2","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*46"]<- Cyp2D6_Tests["*46","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*47"]<- Cyp2D6_Tests["*47","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*48"]<- Cyp2D6_Tests["*48","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*49"]<- Cyp2D6_Tests["*49","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*50"]<- Cyp2D6_Tests["*50","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*51"]<- Cyp2D6_Tests["*51","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*52"]<- Cyp2D6_Tests["*52","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*53"]<- Cyp2D6_Tests["*53","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*54"]<- Cyp2D6_Tests["*54","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*55"]<- Cyp2D6_Tests["*55","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*56"]<- Cyp2D6_Tests["*56","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*57"]<- Cyp2D6_Tests["*57","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*58"]<- Cyp2D6_Tests["*58","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*59"]<- Cyp2D6_Tests["*59","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*60"]<- Cyp2D6_Tests["*60","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*61"]<- Cyp2D6_Tests["*61","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*62"]<- Cyp2D6_Tests["*62","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*63"]<- Cyp2D6_Tests["*63","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*64"]<- Cyp2D6_Tests["*64","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*65"]<- Cyp2D6_Tests["*65","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*66"]<- Cyp2D6_Tests["*66","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*67"]<- Cyp2D6_Tests["*67","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*68"]<- Cyp2D6_Tests["*68","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*69"]<- Cyp2D6_Tests["*69","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*70"]<- Cyp2D6_Tests["*70","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*71"]<- Cyp2D6_Tests["*71","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*72"]<- Cyp2D6_Tests["*72","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*73"]<- Cyp2D6_Tests["*73","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*74"]<- Cyp2D6_Tests["*74","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*75"]<- Cyp2D6_Tests["*75","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*79"]<- Cyp2D6_Tests["*79","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*80"]<- Cyp2D6_Tests["*80","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*81"]<- Cyp2D6_Tests["*81","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*82"]<- Cyp2D6_Tests["*82","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*83"]<- Cyp2D6_Tests["*83","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*84"]<- Cyp2D6_Tests["*84","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*85"]<- Cyp2D6_Tests["*85","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*86"]<- Cyp2D6_Tests["*86","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*87"]<- Cyp2D6_Tests["*87","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*88"]<- Cyp2D6_Tests["*88","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*89"]<- Cyp2D6_Tests["*89","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*90"]<- Cyp2D6_Tests["*90","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*91"]<- Cyp2D6_Tests["*91","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*92"]<- Cyp2D6_Tests["*92","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*93"]<- Cyp2D6_Tests["*93","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*94"]<- Cyp2D6_Tests["*94","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*95"]<- Cyp2D6_Tests["*95","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*96"]<- Cyp2D6_Tests["*96","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*97"]<- Cyp2D6_Tests["*97","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*98"]<- Cyp2D6_Tests["*98","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*99"]<- Cyp2D6_Tests["*99","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*100"]<- Cyp2D6_Tests["*100","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*101"]<- Cyp2D6_Tests["*101","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*102"]<- Cyp2D6_Tests["*102","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*103"]<- Cyp2D6_Tests["*103","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*104"]<- Cyp2D6_Tests["*104","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*105"]<- Cyp2D6_Tests["*105","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*106"]<- Cyp2D6_Tests["*106","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*107"]<- Cyp2D6_Tests["*107","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*108"]<- Cyp2D6_Tests["*108","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*109"]<- Cyp2D6_Tests["*109","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*110"]<- Cyp2D6_Tests["*110","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*111"]<- Cyp2D6_Tests["*111","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*112"]<- Cyp2D6_Tests["*112","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*113"]<- Cyp2D6_Tests["*113","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*114"]<- Cyp2D6_Tests["*114","MedMPact"]
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*35xN>2"]<- "No"
Cyp2D6_Phenotypes_Test[Cyp2D6_Phenotypes_Test== "*45xN>2"]<- "No"

#Creates an addtional column for "Cyp2C19_Phenotypes_Test" called "Test"
#if a phenotype has both genes covered, or "Yes" for both A1 and A2 columns, it is called "Observable", if only 1 of 2 or none say "Yes", it says "Not"
Cyp2D6_Phenotypes_Test$Test<- ifelse(Cyp2D6_Phenotypes_Test$A1 == "Yes"& Cyp2D6_Phenotypes_Test$A2== "Yes", "Observable", "Not")
colnames(Cyp2D6_Phenotypes_Test)<- c("Al.1", "A2.1", "Score", "Phenotype", "EHR", "Multiply", "Test")

Cyp2D6_Phenotypes_Test$A1<- Cyp2D6_Phenotypes$A1
Cyp2D6_Phenotypes_Test$A2<- Cyp2D6_Phenotypes$A2



###The next 9 subsections represent calculations for clinical sensitity for each ethnic group using the "Cyp2C19_Phenotypes_Test"
###replaces the allele name with the frequency it occurs in each table
###African Race frequencies
AfricanPhenotypes<- Cyp2D6_Phenotypes_Test
AfricanPhenotypes[AfricanPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","African American/Afro-Carribbean Allele Frequency"] 
AfricanPhenotypes[AfricanPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","African American/Afro-Carribbean Allele Frequency"]
AfricanPhenotypes[AfricanPhenotypes== "*35xN>2"]<- 0
AfricanPhenotypes[AfricanPhenotypes== "*45xN>2"]<- 0

#Calculate Probabilities of each Diplotype
AfricanPhenotypes$A1<- as.numeric(AfricanPhenotypes$A1)
AfricanPhenotypes$A2<- as.numeric(AfricanPhenotypes$A2)
AfricanPhenotypes$Multiply<- as.numeric(AfricanPhenotypes$Multiply)
AfricanPhenotypes$Probability<- AfricanPhenotypes$A1*AfricanPhenotypes$A2
AfricanPhenotypes$Probability<- AfricanPhenotypes$Probability*AfricanPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
AfricanAbnormal<- subset(AfricanPhenotypes, Score <1 | Score>2)
SumAfricanAbnormal<- sum(AfricanAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
AfricanAbnormalCorrect<- subset(AfricanAbnormal, Test== "Observable")
SumAfricanAbnormalCorrect<- sum(AfricanAbnormalCorrect$Probability)

#Sensitivity
AfricanSensitivity<- SumAfricanAbnormalCorrect/SumAfricanAbnormal*100



#######American Allele Frequency
AmericanPhenotypes<- Cyp2D6_Phenotypes_Test
AmericanPhenotypes[AmericanPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","American Allele Frequency"] 
AmericanPhenotypes[AmericanPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","American Allele Frequency"]
AmericanPhenotypes[AmericanPhenotypes== "*35xN>2"]<- 0
AmericanPhenotypes[AmericanPhenotypes== "*45xN>2"]<- 0



#Calculate Probabilities of each Diplotype
AmericanPhenotypes$A1<- as.numeric(AmericanPhenotypes$A1)
AmericanPhenotypes$A2<- as.numeric(AmericanPhenotypes$A2)
AmericanPhenotypes$Multiply<- as.numeric(AmericanPhenotypes$Multiply)
AmericanPhenotypes$Probability<- AmericanPhenotypes$A1*AmericanPhenotypes$A2
AmericanPhenotypes$Probability<- AmericanPhenotypes$Probability*AmericanPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
AmericanAbnormal<- subset(AmericanPhenotypes, Score <1 | Score>2)
SumAmericanAbnormal<- sum(AmericanAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
AmericanAbnormalCorrect<- subset(AmericanAbnormal, Test== "Observable")
SumAmericanAbnormalCorrect<- sum(AmericanAbnormalCorrect$Probability)

#Sensitivity
AmericanSensitivity<- SumAmericanAbnormalCorrect/SumAmericanAbnormal*100



#########Central/South Asian Allele Frequency
CentralPhenotypes<- Cyp2D6_Phenotypes_Test
CentralPhenotypes[CentralPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","Central/South Asian Allele Frequency"] 
CentralPhenotypes[CentralPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","Central/South Asian Allele Frequency"]
CentralPhenotypes[CentralPhenotypes== "*35xN>2"]<- 0
CentralPhenotypes[CentralPhenotypes== "*45xN>2"]<- 0



#Calculate Probabilities of each Diplotype
CentralPhenotypes$A1<- as.numeric(CentralPhenotypes$A1)
CentralPhenotypes$A2<- as.numeric(CentralPhenotypes$A2)
CentralPhenotypes$Multiply<- as.numeric(CentralPhenotypes$Multiply)
CentralPhenotypes$Probability<- CentralPhenotypes$A1*CentralPhenotypes$A2
CentralPhenotypes$Probability<- CentralPhenotypes$Probability*CentralPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
CentralAbnormal<- subset(CentralPhenotypes, Score <1 | Score>2)
SumCentralAbnormal<- sum(CentralAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
CentralAbnormalCorrect<- subset(CentralAbnormal, Test== "Observable")
SumCentralAbnormalCorrect<- sum(CentralAbnormalCorrect$Probability)

#Sensitivity
CentralSensitivity<- SumCentralAbnormalCorrect/SumCentralAbnormal*100



#######East Asian Allele Frequency
EastPhenotypes<- Cyp2D6_Phenotypes_Test
EastPhenotypes[EastPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","East Asian Allele Frequency"] 
EastPhenotypes[EastPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","East Asian Allele Frequency"]
EastPhenotypes[EastPhenotypes== "*35xN>2"]<- 0
EastPhenotypes[EastPhenotypes== "*45xN>2"]<- 0



#Calculate Probabilities of each Diplotype
EastPhenotypes$A1<- as.numeric(EastPhenotypes$A1)
EastPhenotypes$A2<- as.numeric(EastPhenotypes$A2)
EastPhenotypes$Multiply<- as.numeric(EastPhenotypes$Multiply)
EastPhenotypes$Probability<- EastPhenotypes$A1*EastPhenotypes$A2
EastPhenotypes$Probability<- EastPhenotypes$Probability*EastPhenotypes$Multiply


###Total Population Frequency of Abnormal Phenotypes
EastAbnormal<- subset(EastPhenotypes, Score <1 | Score>2)
SumEastAbnormal<- sum(EastAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
EastAbnormalCorrect<- subset(EastAbnormal, Test== "Observable")
SumEastAbnormalCorrect<- sum(EastAbnormalCorrect$Probability)

#Sensitivity
EastSensitivity<- SumEastAbnormalCorrect/SumEastAbnormal*100



############European Allele Frequency
EuropeanPhenotypes<- Cyp2D6_Phenotypes_Test
EuropeanPhenotypes[EuropeanPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","European Allele Frequency"] 
EuropeanPhenotypes[EuropeanPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","European Allele Frequency"]
EuropeanPhenotypes[EuropeanPhenotypes== "*35xN>2"]<- 0
EuropeanPhenotypes[EuropeanPhenotypes== "*45xN>2"]<- 0

#Calculate Probabilities of each Diplotype
EuropeanPhenotypes$A1<- as.numeric(EuropeanPhenotypes$A1)
EuropeanPhenotypes$A2<- as.numeric(EuropeanPhenotypes$A2)
EuropeanPhenotypes$Multiply<- as.numeric(EuropeanPhenotypes$Multiply)
EuropeanPhenotypes$Probability<- EuropeanPhenotypes$A1*EuropeanPhenotypes$A2
EuropeanPhenotypes$Probability<- EuropeanPhenotypes$Probability*EuropeanPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
EuropeanAbnormal<- subset(EuropeanPhenotypes, Score <1 | Score>2)
SumEuropeanAbnormal<- sum(EuropeanAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected
EuropeanAbnormalCorrect<- subset(EuropeanAbnormal, Test== "Observable")
SumEuropeanAbnormalCorrect<- sum(EuropeanAbnormalCorrect$Probability)

#Sensitivity
EuropeanSensitivity<- SumEuropeanAbnormalCorrect/SumEuropeanAbnormal*100



########Latino Allele Frequency 
LatinoPhenotypes<- Cyp2D6_Phenotypes_Test
LatinoPhenotypes[LatinoPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","Latino Allele Frequency"] 
LatinoPhenotypes[LatinoPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","Latino Allele Frequency"]
LatinoPhenotypes[LatinoPhenotypes== "*35xN>2"]<- 0
LatinoPhenotypes[LatinoPhenotypes== "*45xN>2"]<- 0



#Calculate Probabilities of each Diplotype
LatinoPhenotypes$A1<- as.numeric(LatinoPhenotypes$A1)
LatinoPhenotypes$A2<- as.numeric(LatinoPhenotypes$A2)
LatinoPhenotypes$Multiply<- as.numeric(LatinoPhenotypes$Multiply)
LatinoPhenotypes$Probability<- LatinoPhenotypes$A1*LatinoPhenotypes$A2
LatinoPhenotypes$Probability<- LatinoPhenotypes$Probability*LatinoPhenotypes$Multiply


###Total Population Frequency of Abnormal Phenotypes
LatinoAbnormal<- subset(LatinoPhenotypes, Score <1 | Score>2)
SumLatinoAbnormal<- sum(LatinoAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected
LatinoAbnormalCorrect<- subset(LatinoAbnormal, Test== "Observable")
SumLatinoAbnormalCorrect<- sum(LatinoAbnormalCorrect$Probability)

#Sensitivity
LatinoSensitivity<- SumLatinoAbnormalCorrect/SumLatinoAbnormal*100



##########Near Eastern Allele Frequency
NearPhenotypes<- Cyp2D6_Phenotypes_Test
NearPhenotypes[NearPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","Near Eastern Allele Frequency"] 
NearPhenotypes[NearPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","Near Eastern Allele Frequency"]
NearPhenotypes[NearPhenotypes== "*35xN>2"]<- 0
NearPhenotypes[NearPhenotypes== "*45xN>2"]<- 0



#Calculate Probabilities of each Diplotype
NearPhenotypes$A1<- as.numeric(NearPhenotypes$A1)
NearPhenotypes$A2<- as.numeric(NearPhenotypes$A2)
NearPhenotypes$Multiply<- as.numeric(NearPhenotypes$Multiply)
NearPhenotypes$Probability<- NearPhenotypes$A1*NearPhenotypes$A2
NearPhenotypes$Probability<- NearPhenotypes$Probability*NearPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
NearAbnormal<- subset(NearPhenotypes, Score <1 | Score>2)
SumNearAbnormal<- sum(NearAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
NearAbnormalCorrect<- subset(NearAbnormal, Test== "Observable")
SumNearAbnormalCorrect<- sum(NearAbnormalCorrect$Probability)

#Sensitivity
NearSensitivity<- SumNearAbnormalCorrect/SumNearAbnormal*100



############Oceanian Allele Frequency
OceanianPhenotypes<- Cyp2D6_Phenotypes_Test
OceanianPhenotypes[OceanianPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","Oceanian Allele Frequency"] 
OceanianPhenotypes[OceanianPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","Oceanian Allele Frequency"]
OceanianPhenotypes[OceanianPhenotypes== "*35xN>2"]<- 0
OceanianPhenotypes[OceanianPhenotypes== "*45xN>2"]<- 0

#Calculate Probabilities of each Diplotype
OceanianPhenotypes$A1<- as.numeric(OceanianPhenotypes$A1)
OceanianPhenotypes$A2<- as.numeric(OceanianPhenotypes$A2)
OceanianPhenotypes$Multiply<- as.numeric(OceanianPhenotypes$Multiply)
OceanianPhenotypes$Probability<- OceanianPhenotypes$A1*OceanianPhenotypes$A2
OceanianPhenotypes$Probability<- OceanianPhenotypes$Probability*OceanianPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
OceanianAbnormal<- subset(OceanianPhenotypes, Score <1 | Score>2)
SumOceanianAbnormal<- sum(OceanianAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
OceanianAbnormalCorrect<- subset(OceanianAbnormal, Test== "Observable")
SumOceanianAbnormalCorrect<- sum(OceanianAbnormalCorrect$Probability)

#Sensitivity
OceanianSensitivity<- SumOceanianAbnormalCorrect/SumOceanianAbnormal*100



#############Sub-Saharan African Allele Frequency
SubPhenotypes<- Cyp2D6_Phenotypes_Test
SubPhenotypes[SubPhenotypes== "*1"]<- Cyp2D6_Frequencies["*1","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*1x2"]<- Cyp2D6_Frequencies["*1x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*1xN>2"]<- Cyp2D6_Frequencies["*1≥3","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*2"]<- Cyp2D6_Frequencies["*2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*2x2"]<- Cyp2D6_Frequencies["*2x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*2xN>2"]<- Cyp2D6_Frequencies["*2≥3","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*3"]<- Cyp2D6_Frequencies["*3","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*3xN"]<- Cyp2D6_Frequencies["*3x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*4"]<- Cyp2D6_Frequencies["*4","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*4xN"]<- Cyp2D6_Frequencies["*4≥2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*5"]<- Cyp2D6_Frequencies["*5","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*6"]<- Cyp2D6_Frequencies["*6","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*6xN"]<- Cyp2D6_Frequencies["*6x2","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*7"]<- Cyp2D6_Frequencies["*7","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*10x2"]<- Cyp2D6_Frequencies["*10x2","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*8"]<- Cyp2D6_Frequencies["*8","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*9"]<- Cyp2D6_Frequencies["*9","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*9x2"]<- Cyp2D6_Frequencies["*9x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*10"]<- Cyp2D6_Frequencies["*10","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*11"]<- Cyp2D6_Frequencies["*11","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*12"]<- Cyp2D6_Frequencies["*12","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*13"]<- Cyp2D6_Frequencies["*13","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*14"]<- Cyp2D6_Frequencies["*14","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*15"]<- Cyp2D6_Frequencies["*15","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*16"]<- Cyp2D6_Frequencies["*16","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*17"]<- Cyp2D6_Frequencies["*17","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*17x2"]<- Cyp2D6_Frequencies["*17x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*18"]<- Cyp2D6_Frequencies["*18","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*19"]<- Cyp2D6_Frequencies["*19","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*20"]<- Cyp2D6_Frequencies["*20","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*21"]<- Cyp2D6_Frequencies["*21","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*22"]<- Cyp2D6_Frequencies["*22","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*23"]<- Cyp2D6_Frequencies["*23","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*24"]<- Cyp2D6_Frequencies["*24","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*25"]<- Cyp2D6_Frequencies["*25","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*26"]<- Cyp2D6_Frequencies["*26","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*27"]<- Cyp2D6_Frequencies["*27","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*28"]<- Cyp2D6_Frequencies["*28","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*29"]<- Cyp2D6_Frequencies["*29","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*29x2"]<- Cyp2D6_Frequencies["*29x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*30"]<- Cyp2D6_Frequencies["*30","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*31"]<- Cyp2D6_Frequencies["*31","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*32"]<- Cyp2D6_Frequencies["*32","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*33"]<- Cyp2D6_Frequencies["*33","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*34"]<- Cyp2D6_Frequencies["*34","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*35"]<- Cyp2D6_Frequencies["*35","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*35x2"]<- Cyp2D6_Frequencies["*35x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*36"]<- Cyp2D6_Frequencies["*36","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*36xN"]<- Cyp2D6_Frequencies["*36x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*37"]<- Cyp2D6_Frequencies["*37","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*38"]<- Cyp2D6_Frequencies["*38","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*39"]<- Cyp2D6_Frequencies["*39","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*40"]<- Cyp2D6_Frequencies["*40","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*41"]<- Cyp2D6_Frequencies["*41","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*41x2"]<- Cyp2D6_Frequencies["*41x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*42"]<- Cyp2D6_Frequencies["*42","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*43"]<- Cyp2D6_Frequencies["*43","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*43xN"]<- Cyp2D6_Frequencies["*43x2","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*44"]<- Cyp2D6_Frequencies["*44","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*45"]<- Cyp2D6_Frequencies["*45","Sub-Saharan African Allele Frequency"] 
SubPhenotypes[SubPhenotypes== "*45x2"]<- Cyp2D6_Frequencies["*45x2","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*46"]<- Cyp2D6_Frequencies["*46","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*47"]<- Cyp2D6_Frequencies["*47","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*48"]<- Cyp2D6_Frequencies["*48","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*49"]<- Cyp2D6_Frequencies["*49","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*50"]<- Cyp2D6_Frequencies["*50","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*51"]<- Cyp2D6_Frequencies["*51","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*52"]<- Cyp2D6_Frequencies["*52","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*53"]<- Cyp2D6_Frequencies["*53","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*54"]<- Cyp2D6_Frequencies["*54","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*55"]<- Cyp2D6_Frequencies["*55","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*56"]<- Cyp2D6_Frequencies["*56","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*57"]<- Cyp2D6_Frequencies["*57","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*58"]<- Cyp2D6_Frequencies["*58","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*59"]<- Cyp2D6_Frequencies["*59","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*60"]<- Cyp2D6_Frequencies["*60","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*61"]<- Cyp2D6_Frequencies["*61","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*62"]<- Cyp2D6_Frequencies["*62","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*63"]<- Cyp2D6_Frequencies["*63","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*64"]<- Cyp2D6_Frequencies["*64","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*65"]<- Cyp2D6_Frequencies["*65","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*66"]<- Cyp2D6_Frequencies["*66","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*67"]<- Cyp2D6_Frequencies["*67","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*68"]<- Cyp2D6_Frequencies["*68","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*69"]<- Cyp2D6_Frequencies["*69","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*70"]<- Cyp2D6_Frequencies["*70","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*71"]<- Cyp2D6_Frequencies["*71","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*72"]<- Cyp2D6_Frequencies["*72","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*73"]<- Cyp2D6_Frequencies["*73","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*74"]<- Cyp2D6_Frequencies["*74","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*75"]<- Cyp2D6_Frequencies["*75","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*79"]<- Cyp2D6_Frequencies["*79","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*80"]<- Cyp2D6_Frequencies["*80","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*81"]<- Cyp2D6_Frequencies["*81","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*82"]<- Cyp2D6_Frequencies["*82","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*83"]<- Cyp2D6_Frequencies["*83","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*84"]<- Cyp2D6_Frequencies["*84","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*85"]<- Cyp2D6_Frequencies["*85","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*86"]<- Cyp2D6_Frequencies["*86","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*87"]<- Cyp2D6_Frequencies["*87","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*88"]<- Cyp2D6_Frequencies["*88","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*89"]<- Cyp2D6_Frequencies["*89","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*90"]<- Cyp2D6_Frequencies["*90","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*91"]<- Cyp2D6_Frequencies["*91","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*92"]<- Cyp2D6_Frequencies["*92","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*93"]<- Cyp2D6_Frequencies["*93","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*94"]<- Cyp2D6_Frequencies["*94","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*95"]<- Cyp2D6_Frequencies["*95","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*96"]<- Cyp2D6_Frequencies["*96","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*97"]<- Cyp2D6_Frequencies["*97","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*98"]<- Cyp2D6_Frequencies["*98","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*99"]<- Cyp2D6_Frequencies["*99","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*100"]<- Cyp2D6_Frequencies["*100","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*101"]<- Cyp2D6_Frequencies["*101","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*102"]<- Cyp2D6_Frequencies["*102","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*103"]<- Cyp2D6_Frequencies["*103","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*104"]<- Cyp2D6_Frequencies["*104","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*105"]<- Cyp2D6_Frequencies["*105","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*106"]<- Cyp2D6_Frequencies["*106","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*107"]<- Cyp2D6_Frequencies["*107","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*108"]<- Cyp2D6_Frequencies["*108","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*109"]<- Cyp2D6_Frequencies["*109","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*110"]<- Cyp2D6_Frequencies["*110","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*111"]<- Cyp2D6_Frequencies["*111","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*112"]<- Cyp2D6_Frequencies["*112","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*113"]<- Cyp2D6_Frequencies["*113","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*114"]<- Cyp2D6_Frequencies["*114","Sub-Saharan African Allele Frequency"]
SubPhenotypes[SubPhenotypes== "*35xN>2"]<- 0
SubPhenotypes[SubPhenotypes== "*45xN>2"]<- 0

#Calculate Probabilities of each Diplotype
SubPhenotypes$A1<- as.numeric(SubPhenotypes$A1)
SubPhenotypes$A2<- as.numeric(SubPhenotypes$A2)
SubPhenotypes$Multiply<- as.numeric(SubPhenotypes$Multiply)
SubPhenotypes$Probability<- SubPhenotypes$A1*SubPhenotypes$A2
SubPhenotypes$Probability<- SubPhenotypes$Probability*SubPhenotypes$Multiply

###Total Population Frequency of Abnormal Phenotypes
SubAbnormal<- subset(SubPhenotypes, Score <1 | Score>2)
SumSubAbnormal<- sum(SubAbnormal$Probability)

###Population Frequency of Abnormal Phenotypes Correctly Detected 
SubAbnormalCorrect<- subset(SubAbnormal, Test== "Observable")
SumSubAbnormalCorrect<- sum(SubAbnormalCorrect$Probability)

#Sensitivity
SubSensitivity<- SumSubAbnormalCorrect/SumSubAbnormal*100


#Results, cummulated results of clinical sensitivity for PGx test for all ethic groups
TestSensitivity<- c(AfricanSensitivity, AmericanSensitivity, CentralSensitivity, EastSensitivity, EuropeanSensitivity, LatinoSensitivity, NearSensitivity, OceanianSensitivity, SubSensitivity)
TestSensitivity<- as.data.frame(TestSensitivity)
rownames(TestSensitivity)<- c("African American/Afro-Caribbean", "American", "Central/South Asian", "East Asian", "European", "Latino", "Near Eastern", "Oceanian", "Sub-Saharan")


#"Cyp2D6_Counts", gives the total number of variants each PGx test selects, and the percent coverge of total variants targeted by each test from the total listed variants listed on PharmGKB
#Calcluations already performed, this is only exporting the values
Cyp2D6_Counts<- as.data.frame(read_excel("Cyp2D6Tests.xlsx", sheet= "Sheet2"))
Cyp2D6_Sensitivity_Tests

